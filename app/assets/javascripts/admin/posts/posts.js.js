// Generated by CoffeeScript 1.7.1
(function() {
  var readURL;

  readURL = function(input) {
    var reader;
    if (input.files && input.files[0]) {
      reader = new FileReader();
      reader.onload = function(e) {
        $(".well").css({
          'background-position': 'center center',
          'background-image': 'url(' + e.target.result + ')',
          'background-repeat': 'no-repeat',
          'background-size': 'cover',
          'overflow': 'hidden'
        });
        $(".well input[name=has_cover_image]").val("Y");
      };
      reader.readAsDataURL(input.files[0]);
    }
  };

  $(document).ready(function() {
    $("body").on("click", ".add-article-image", function(e) {
      e.preventDefault();
      $('#post-post-image').trigger('click');
    });
    $("#post-post-image").change(function() {
      readURL(this);
    });
    $("body").on("click", ".add-profile-image", function(e) {
      e.preventDefault();
      $('#admin-cover-picture').trigger('click');
    });
    $("#admin-cover-picture").change(function() {
      readURL(this);
      $('.add-profile-image').addClass('hidden');
      $('.remove-profile-image').removeClass('hidden');
    });
    $("body").on("click", ".remove-profile-image", function(e) {
      var input;
      input = $("#admin-cover-picture");
      $(".well").attr("style", "");
      $(this).addClass('hidden');
      $('.add-profile-image').removeClass('hidden');
      $(".well input[name=has_cover_image]").val('');
      input.replaceWith(input.val('').clone(true));
    });
    $("body").on("keypress", "#addAdditionalDataInput", function(e) {
      $("#addAdditionalDataInput").val($("#addAdditionalDataInput").val().toLowerCase().replace(" ", "-"));
      if (e.which === 13) {
        e.preventDefault();
        $(".addAdditionalDataInput").trigger("click");
      }
    });
    $("body").on("click", ".addAdditionalDataInput", function() {
      $.ajax({
        type: "POST",
        url: "/admin/posts/create_additional_data",
        data: "key=" + $("#addAdditionalDataInput").val(),
        dataType: "html",
        success: function(data) {
          $(".additionalDataOptions").append(data);
          $("#addAdditionalDataInput").val("");
        }
      });
    });
    $("body").on("click", ".remove-additional-group", function(e) {
      e.preventDefault();
      if (confirm("Are you sure?")) {
        $(this).closest(".form-group").remove();
      }
    });
  });

}).call(this);
